function [x, y, z] = trilateration(x1, x2, x3, x4, r1, r2, r3,  r4)

F = [x4(1) - x1(1), x4(2) - x1(2), x4(3) - x1(3);
     x4(1) - x2(1), x4(2) - x2(2), x4(3) - x2(3);
     x4(1) - x3(1), x4(2) - x3(2), x4(3) - x3(3)];
 
g = [x4(1)^2 - x1(1)^2 + x4(2)^2 - x1(2)^2 + x4(3)^2 - x1(3)^2;
     x4(1)^2 - x2(1)^2 + x4(2)^2 - x2(2)^2 + x4(3)^2 - x2(3)^2;
     x4(1)^2 - x3(1)^2 + x4(2)^2 - x3(2)^2 + x4(3)^2 - x3(3)^2];

u = [r1^2 - r4^2;
     r2^2 - r4^2;
     r3^2 - r4^2];
 
ans = 0.5*pinv(F)*(g+u);

x = ans(1);
y = ans(2);
z = ans(3);
end